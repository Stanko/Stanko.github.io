{"version":3,"sources":["app.js"],"names":["commentForm","document","querySelector","commentFormInputs","querySelectorAll","slugInput","optionsSlugInput","nameInput","lastNameInput","emailInput","messageInput","errorMessagesDiv","sendFailedDiv","sendSucceededDiv","overlayDiv","post","url","data","callback","errorCallback","xhr","XMLHttpRequest","open","setRequestHeader","onload","status","responseText","send","encodeURI","addEventListener","e","preventDefault","innerHTML","style","display","slug","value","trim","optionsSlug","name","lastName","email","message","error","fatalError","messages","length","push","search","join","params","forEach","input","target","getAttribute","text","reset","root","fuzzy","window","PREFIX","SUFFIX","calculateScore","string","split","recursiveMatch","pattern","compareString","result","idx","ch","arr","slice","map","str","concat","apply","simpleFilter","array","filter","test","match","opts","pre","caseSensitive","toLowerCase","el","rendered","score","reduce","prev","next","element","extract","index","original","sort","a","b","compare","options","title","searchInput","searchToggles","searchResults","html","prevSearch","MIN_CHARACTERS","renderResult","setTimeout","classList","toggle","focus","remove","newSearch","results","posts"],"mappings":"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","file":"app.js","sourcesContent":["const commentForm = document.querySelector('.CommentForm');\nconst commentFormInputs = document.querySelectorAll('.CommentForm-input');\nconst slugInput = document.querySelector('.CommentForm-input--slug');\nconst optionsSlugInput = document.querySelector('.CommentForm-input--optionsSlug');\nconst nameInput = document.querySelector('.CommentForm-input--name');\nconst lastNameInput = document.querySelector('.CommentForm-input--lastName');\nconst emailInput = document.querySelector('.CommentForm-input--email');\nconst messageInput = document.querySelector('.CommentForm-input--message');\nconst errorMessagesDiv = document.querySelector('.CommentForm-errorMessages');\nconst sendFailedDiv = document.querySelector('.CommentForm-sendFailed');\nconst sendSucceededDiv = document.querySelector('.CommentForm-sendSucceeded');\nconst overlayDiv = document.querySelector('.CommentForm-overlay');\n\nfunction post(url, data, callback, errorCallback) {\n  const xhr = new XMLHttpRequest();\n  xhr.open('POST', url);\n  xhr.setRequestHeader('Content-Type', 'application/x-www-form-urlencoded');\n  xhr.onload = function() {\n    if (xhr.status === 200) {\n      callback(xhr.responseText);\n    } else if (xhr.status !== 200) {\n      errorCallback(xhr.responseText);\n    }\n  };\n  xhr.send(encodeURI(data));\n}\n\nif (commentForm) {\n  commentForm.addEventListener('submit', (e) => {\n    e.preventDefault();\n    errorMessagesDiv.innerHTML = '';\n    sendFailedDiv.style.display = 'none';\n    sendSucceededDiv.style.display = 'none';\n\n    const slug = slugInput.value.trim();\n    const optionsSlug = optionsSlugInput.value.trim();\n    const name = nameInput.value.trim();\n    const lastName = lastNameInput.value.trim();\n    const email = emailInput.value.trim();\n    const message = messageInput.value.trim();\n\n    let error = false;\n    let fatalError = false;\n    const messages = [];\n\n    if (slug === '' || slug !== optionsSlug || lastName !== '') {\n      fatalError = true;\n    }\n\n    if (name.length < 2) {\n      error = true;\n      messages.push('Please enter name');\n    }\n\n    if (email.search(/^[a-zA-Z0-9.!#$%&â€™*+/=?^_`{|}~-]+@[a-zA-Z0-9-]+(?:\\.[a-zA-Z0-9-]+)*$/) === -1) {\n      error = true;\n      messages.push('Please enter valid email');\n    }\n\n    if (message.length < 2) {\n      error = true;\n      messages.push('Please enter message');\n    }\n\n    if (fatalError) {\n      return false;\n    }\n\n    if (error) {\n      errorMessagesDiv.innerHTML = messages.join('<br>');\n      return false;\n    }\n\n\n    const params = [];\n    commentFormInputs.forEach(input => {\n      params.push(`${ input.name }=${ input.value }`);\n    });\n\n    overlayDiv.style.display = 'block';\n\n    post(\n      e.target.getAttribute('data-action'),\n      params.join('&'),\n      function(text){\n        commentForm.reset();\n        sendSucceededDiv.style.display = 'block';\n        overlayDiv.style.display = 'none';\n      },\n      function(text){\n        sendFailedDiv.style.display = 'block';\n        overlayDiv.style.display = 'none';\n      }\n    );\n  });\n}\n\n/*\n * Fuzzy\n * https://github.com/myork/fuzzy\n *\n * Copyright (c) 2012 Matt York\n * Licensed under the MIT license.\n */\n\n(function() {\n\nvar root = this;\n\nvar fuzzy = {};\n\nwindow.fuzzy = fuzzy;\n\n// prefix & suffix for score calculation\n// need this in order to split matching & scoring in two phases\nvar PREFIX = '<strong>';\nvar SUFFIX = '</strong>';\n\nvar calculateScore = function(string) {\n  return string.split(PREFIX).length - 1 + (string.split(SUFFIX + PREFIX).length - 1) * 10;\n};\n\nvar recursiveMatch = function(pattern, string, compareString) {\n  if (pattern.length === 0 || string.length === 0 || pattern.length > string.length) {\n    return [string];\n  }\n\n  var result = [];\n\n  for(var idx = 0; idx < string.length; idx++) {\n    if (pattern[0] === compareString[idx]) {\n      var ch = PREFIX + string[idx] + SUFFIX;\n\n      var arr = recursiveMatch(pattern.slice(1), string.slice(idx + 1), compareString.slice(idx + 1));\n\n      arr = arr.map(function(str){\n        return string.slice(0, idx) + ch + str;\n      });\n\n      result[result.length] = arr;\n    }\n  }\n\n  return [].concat.apply([], result); // flatten\n};\n\n// Return all elements of `array` that have a fuzzy\n// match against `pattern`.\nfuzzy.simpleFilter = function(pattern, array) {\n  return array.filter(function(string) {\n    return fuzzy.test(pattern, string);\n  });\n};\n\n// Does `pattern` fuzzy match `string`?\nfuzzy.test = function(pattern, string) {\n  return fuzzy.match(pattern, string) !== null;\n};\n\nfuzzy.match = function(pattern, string, opts) {\n  opts = opts || {};\n\n  /**\n    pre - prefix\n    post - suffix\n    compareString - String to compare against. This might be a\n      lowercase version of the raw string\n  **/\n  var pre = opts.pre || '<strong>'\n    , post = opts.post || '</strong>'\n    , compareString = opts.caseSensitive && string || string.toLowerCase();\n\n  pattern = opts.caseSensitive && pattern || pattern.toLowerCase();\n\n  var result = recursiveMatch(pattern, string, compareString)\n    .filter(function(el) {\n      return el.split(PREFIX).length - 1 === pattern.length;\n    });\n\n  if (result.length === 0) {\n    return null;\n  }\n\n  return result\n    .map(function(el) {\n      return {\n        rendered: el.split(PREFIX).join(pre).split(SUFFIX).join(post),\n        score: calculateScore(el),\n      };\n    })\n\n    .reduce(function(prev, next) {\n      return prev.score > next.score ? prev : next;\n    });\n}\n\n// The normal entry point. Filters `arr` for matches against `pattern`.\n// It returns an array with matching values of the type:\n//\n//     [{\n//         string:   '<b>lah' // The rendered string\n//       , index:    2        // The index of the element in `arr`\n//       , original: 'blah'   // The original element in `arr`\n//     }]\n//\n// `opts` is an optional argument bag. Details:\n//\n//    opts = {\n//        // string to put before a matching character\n//        pre:     '<b>'\n//\n//        // string to put after matching character\n//      , post:    '</b>'\n//\n//        // Optional function. Input is an entry in the given arr`,\n//        // output should be the string to test `pattern` against.\n//        // In this example, if `arr = [{crying: 'koala'}]` we would return\n//        // 'koala'.\n//      , extract: function(arg) { return arg.crying; }\n//    }\nfuzzy.filter = function(pattern, arr, opts) {\n  if(!arr || arr.length === 0) {\n    return []\n  }\n  if (typeof pattern !== 'string') {\n    return arr\n  }\n  opts = opts || {};\n  return arr\n    .reduce(function(prev, element, idx, arr) {\n      var str = element;\n      if(opts.extract) {\n        str = opts.extract(element);\n      }\n      var rendered = fuzzy.match(pattern, str, opts);\n      if(rendered != null) {\n        prev[prev.length] = {\n            string: rendered.rendered\n          , score: rendered.score\n          , index: idx\n          , original: element\n        };\n      }\n      return prev;\n    }, [])\n\n    // Sort by score. Browsers are inconsistent wrt stable/unstable\n    // sorting, so force stable by using the index in the case of tie.\n    // See http://ofb.net/~sethml/is-sort-stable.html\n    .sort(function(a,b) {\n      var compare = b.score - a.score;\n      if(compare) return compare;\n      return a.index - b.index;\n    });\n};\n\n\n}());\n\nconst options = {\n  extract: function(el) { return el.title; }\n};\n\nconst search = document.querySelector('.Search');\nconst searchInput = document.querySelector('.Search-input');\nconst searchToggles = document.querySelectorAll('.Search-toggle');\nconst searchResults = document.querySelector('.Search-results');\nconst html = document.querySelector('html');\n\nlet prevSearch = '';\n\nconst MIN_CHARACTERS = 1;\n\nfunction renderResult(title, url) {\n  return `<div><a href=\"${ url }\">${ title }</a></div>`;\n}\n\n\nsearchToggles.forEach(element => {\n  element.addEventListener('click', function() {\n    if (search.style.display === 'none' || !search.style.display) {\n      search.style.display = 'block';\n      setTimeout(function(){\n        html.classList.toggle('Html--searchActive');\n        searchInput.focus();\n      }, 10);\n    } else {\n      html.classList.remove('Html--searchActive');\n\n      setTimeout(function(){\n        search.style.display = 'none';\n      }, 500);\n\n    }\n  });\n});\n\nsearchInput.addEventListener('keyup', function() {\n  const newSearch = searchInput.value.trim();\n\n  if (prevSearch === newSearch) {\n    return;\n  }\n\n  if (newSearch.length < MIN_CHARACTERS) {\n    searchResults.innerHTML = '';\n    prevSearch = '';\n    return;\n  }\n\n  const results = fuzzy.filter(newSearch, posts, options);\n\n  if (results.length) {\n    const html = results.map(result => renderResult(result.string, result.original.url)).join('');\n    searchResults.innerHTML = html;\n  } else {\n    searchResults.innerHTML = '<div class=\"Search-noResults\">No results</div>';\n  }\n\n  prevSearch = newSearch;\n\n});\n"],"sourceRoot":"/source/"}