<!doctype html><html lang=en><head><meta charset=utf-8><meta content="width=device-width,initial-scale=1.0" name=viewport><title>Animate React component by calling 'setState' in 'componentDidMount' · Muffin Man</title><meta content="On the frontend, we do a lot of animations. Most of the simple animations I create by using CSS transitions.
Either I will change class or inline styl…" name=description><meta content="Muffin Man" property=og:site_name><meta content="Animate React component by calling 'setState' in 'componentDidMount'" property=og:title><meta content="On the frontend, we do a lot of animations. Most of the simple animations I create by using CSS transitions.
Either I will change class or inline styl…" property=og:description><meta content=https://muffinman.io/blog/react-rerender-in-component-did-mount/ property=og:url><meta content="Animate React component by calling 'setState' in 'componentDidMount'" name=twitter:title><meta content="On the frontend, we do a lot of animations. Most of the simple animations I create by using CSS transitions.
Either I will change class or inline styl…" name=twitter:description><meta content=https://muffinman.io/img/cover.png property=twitter:image><meta content=https://muffinman.io/img/cover.png property=og:image><link href=/favicon/icon.ico rel=icon sizes=any><link href=/favicon/icon.svg rel=icon type=image/svg+xml><link href=/favicon/icon-180.png rel=apple-touch-icon><link href=/favicon/manifest.webmanifest rel=manifest><link href=/style.css rel=stylesheet><link href=/atom.xml rel=alternate title=RSS type=application/rss+xml><body><div id=page><a class=jump-to-content href=#content>Jump to content</a><header class=menu><div class=container><a aria-label=Home class=menu__logo href=/> <svg viewbox="0 0 40 20" aria-hidden=true class=logo xmlns=http://www.w3.org/2000/svg> <lineargradient id=logo-gradient> <stop offset=0% stop-color=var(--gradient-color-1) /> <stop offset=70% stop-color=var(--gradient-color-2) /> </lineargradient> <path d="M19.79.5h-2.603c-2.56 0-5.04 1.377-6.003 2.754C10.22 1.877 7.742.5 5.181.5H.5v19h4.681V5.181c1.79.083 3.855 1.35 3.855 3.993V19.5h4.296V9.174c0-2.644 2.065-3.91 3.855-3.993V19.5h5.204V5.181c1.79.083 3.855 1.35 3.855 3.993V19.5h4.296V9.174c0-2.644 2.065-3.91 3.855-3.993V19.5h4.681V.5h-4.68c-2.562 0-5.04 1.377-6.004 2.754C27.43 1.877 24.952.5 22.391.5Z" fill=url(#logo-gradient) stroke-linecap=round stroke-linejoin=round stroke-width=2px vector-effect=non-scaling-stroke /> </svg> </a><nav class="nav nav--header"><a class=nav__item href=/>Home</a><span aria-hidden=true>/</span><a class=nav__item href=/archive/> Archive </a><span aria-hidden=true>/</span><a class="nav__item nav__item--with-icon" title="On my Instagram profile" href=https://instagram.com/muffinman_io/ rel=noopener target=_blank> Art <svg viewbox="0 0 20 20" aria-hidden=true class=nav__external-icon height=10 width=10 xmlns=http://www.w3.org/2000/svg> <g fill=none stroke=currentColor stroke-linecap=round stroke-linejoin=round stroke-width=2.5> <path d="M 0 20 20 0 M 8 0 20 0 20 12"/> </g> </svg> </a><span aria-hidden=true>/</span><a class=nav__item href=/about/> About </a><span aria-hidden=true>/</span><button class="nav__item nav__item--with-icon" data-micromodal-trigger=modal-menu>Search <svg viewbox="0 0 20 32" aria-hidden=true class=nav__search-icon height=16 width=10 xmlns=http://www.w3.org/2000/svg> <g fill=none stroke=currentColor stroke-linecap=round stroke-width=3> <circle cx=10 cy=10 r=10 /> <path d="M 10 20 L 10 32"/> </g> </svg></button></nav><button aria-label=Menu class=menu__toggle data-micromodal-trigger=modal-menu><span></span> <span></span> <span></span></button></div></header><div class=menu-stripe></div><section class=main id=content role=main tabindex=-1><div class=post__top><div class="container post__top-content"><h1 class=post__title>Animate React component by calling 'setState' in 'componentDidMount'</h1><div class=post__date>23. June 2017</div><div class=post__info><div>Posted in <a href=/archive/#react>React</a></div><span class=post__info-separator>·</span> 6 minutes read <div class=post__comments-link><a class=scroll-to href=#comments>8 Comments</a></div></div></div></div><div class=container><div class=content><p>On the frontend, we do a lot of animations. Most of the simple animations I create by using CSS transitions. Either I will change class or inline style of the element, and define transitions in CSS file.<p>Easiest way to do this in React is to render initial state, and then when it renders, change the state to apply class or style to animate. The easiest way to do it in React is to change state in <code>componentDidMount</code>. Setting state in <code>componentDidMount</code> is considered to be anti-pattern, as it forces rerender and can lead to property/layout thrashing. But in our case, that is exactly what we want to do.<p>When we do that, we hit the wall - only second state is rendered and there is no transition between two states. It happens because of browsers optimization - <strong>browsers are not rerendering stuff that changed in the same animation frame.</strong> But they merge changes and render the end result.<p>The problem I just described is not React exclusive, but browser related. Same will happen if we try something like this:<pre class=language-tsx data-lang=tsx style=background-color:#fafafa;color:#383a42;><code class=language-tsx data-lang=tsx><span style=color:#a626a4;>const </span><span style=color:#e45649;>element </span><span style=color:#a626a4;>= </span><span>document.</span><span style=color:#0184bc;>querySelector</span><span>(</span><span style=color:#50a14f;>'.AnimateMe'</span><span>);
</span><span style=color:#e45649;>element</span><span>.style.height </span><span style=color:#a626a4;>= </span><span style=color:#50a14f;>'50px'</span><span>;
</span><span style=color:#e45649;>element</span><span>.style.height </span><span style=color:#a626a4;>= </span><span style=color:#50a14f;>'250px'</span><span>;
</span></code></pre><p>So let's start with example of the problem.</p><span id=continue-reading></span><h2 id=animate-component-by-changing-state-in-componentdidmount-doesn-t-work>Animate component by changing state in <code>componentDidMount</code> doesn't work<a aria-label="Anchor link for: animate-component-by-changing-state-in-componentdidmount-doesn-t-work" title="Anchor link for: animate-component-by-changing-state-in-componentdidmount-doesn-t-work" class=header-anchor href=#animate-component-by-changing-state-in-componentdidmount-doesn-t-work><span aria-hidden=true class=sr-only>#</span></a></h2><p>The scenario I described above. Element height depends on <code>this.state.animation</code> property. It is initially set to <code>false</code> and element height should be 50px. In <code>componentDidMount</code> we'll change the value of <code>this.props.animation</code> to <code>true</code> and element height should be 250px. As we added transition, it should animate.<p>But it doesn't as all of this happens really fast, and browser decides to merge changes and render only the end result. This way our element immediately gets height of 250px.<pre class=language-tsx data-lang=tsx style=background-color:#fafafa;color:#383a42;><code class=language-tsx data-lang=tsx><span style=color:#a626a4;>import </span><span style=color:#e45649;>React</span><span>, { </span><span style=color:#e45649;>Component </span><span>} </span><span style=color:#a626a4;>from </span><span style=color:#50a14f;>'react'</span><span>;
</span><span>
</span><span style=color:#a626a4;>export default class </span><span style=color:#c18401;>AnimateMe </span><span style=color:#a626a4;>extends </span><span style=color:#c18401;>Component {
</span><span style=color:#c18401;>  </span><span style=color:#a626a4;>constructor</span><span style=color:#c18401;>(</span><span style=color:#e45649;>props</span><span style=color:#c18401;>) {
</span><span style=color:#c18401;>    </span><span style=color:#e45649;>super</span><span style=color:#c18401;>(</span><span style=color:#e45649;>props</span><span style=color:#c18401;>);
</span><span style=color:#c18401;>
</span><span style=color:#c18401;>    </span><span style=color:#e45649;>this</span><span style=color:#c18401;>.</span><span style=color:#e45649;>state </span><span style=color:#a626a4;>= </span><span style=color:#c18401;>{
</span><span style=color:#c18401;>      animate: false,
</span><span style=color:#c18401;>    };
</span><span style=color:#c18401;>  }
</span><span style=color:#c18401;>
</span><span style=color:#c18401;>  </span><span style=color:#0184bc;>componentDidMount</span><span style=color:#c18401;>() {
</span><span style=color:#c18401;>    </span><span style=color:#e45649;>this</span><span style=color:#c18401;>.</span><span style=color:#0184bc;>setState</span><span style=color:#c18401;>({ animate: true });
</span><span style=color:#c18401;>  }
</span><span style=color:#c18401;>
</span><span style=color:#c18401;>  </span><span style=color:#0184bc;>render</span><span style=color:#c18401;>() {
</span><span style=color:#c18401;>    </span><span style=color:#a626a4;>return </span><span style=color:#c18401;>(
</span><span style=color:#c18401;>      <</span><span style=color:#e45649;>div
</span><span style=color:#c18401;>        style</span><span style=color:#a626a4;>=</span><span style=color:#c18401;>{ {
</span><span style=color:#c18401;>          background: </span><span style=color:#50a14f;>'#eee'</span><span style=color:#c18401;>,
</span><span style=color:#c18401;>          border: </span><span style=color:#50a14f;>'1px solid black'</span><span style=color:#c18401;>,
</span><span style=color:#c18401;>          height: </span><span style=color:#e45649;>this</span><span style=color:#c18401;>.</span><span style=color:#e45649;>state</span><span style=color:#c18401;>.</span><span style=color:#e45649;>animate </span><span style=color:#a626a4;>? </span><span style=color:#c18401;>250 </span><span style=color:#a626a4;>: </span><span style=color:#c18401;>50,
</span><span style=color:#c18401;>          margin: 20,
</span><span style=color:#c18401;>          padding: 20,
</span><span style=color:#c18401;>          transition: </span><span style=color:#50a14f;>'all 2s'</span><span style=color:#c18401;>,
</span><span style=color:#c18401;>        } }
</span><span style=color:#c18401;>      >
</span><span style=color:#c18401;>        Animate my height
</span><span style=color:#c18401;>      &LT/</span><span style=color:#e45649;>div</span><span style=color:#c18401;>>
</span><span style=color:#c18401;>    );
</span><span style=color:#c18401;>  }
</span><span style=color:#c18401;>}
</span></code></pre><iframe src="//codepen.io/stanko/embed/preview/XgaNyq/?height=400&theme-id=light&default-tab=result" allowfullscreen allowtransparency frameborder=no height=400px scrolling=no>See the Pen <a href=http://codepen.io/stanko/pen/XgaNyq/>Rerender React component in componentDidMount - Step 1</a> by Stanko (<a href=http://codepen.io/stanko>@stanko</a>) on <a href=http://codepen.io>CodePen</a>.</iframe><h2 id=solution-add-a-short-timeout>Solution, add a short timeout<a aria-label="Anchor link for: solution-add-a-short-timeout" title="Anchor link for: solution-add-a-short-timeout" class=header-anchor href=#solution-add-a-short-timeout><span aria-hidden=true class=sr-only>#</span></a></h2><p>I've run multiple times into this problem, but I was lazy to dig deeper and find the real reason why it is happening. My solution was to add a timeout, first I tried immediate timeout (<code>setTimeout(fn, 0)</code>), but alas, it didn't work in some browsers (as it happened too fast again and browser did their optimizations). Then I increased it to the magical value 50 (<code>setTimeout(fn, 50)</code>), and it worked in every browser.<p>Now I get the reason why it works. Because 50ms is larger than animation frame (which is around 16ms to achieve 60fps).<p><small>(I'll show you just the part of the code that is changed)</small><pre class=language-tsx data-lang=tsx style=background-color:#fafafa;color:#383a42;><code class=language-tsx data-lang=tsx><span style=color:#a626a4;>...
</span><span>  </span><span style=color:#0184bc;>componentDidMount</span><span>() {
</span><span>    </span><span style=color:#a0a1a7;>// Added timeout
</span><span>    </span><span style=color:#a626a4;>const </span><span style=color:#e45649;>ANIMATION_TIMEOUT </span><span style=color:#a626a4;>= </span><span style=color:#c18401;>50</span><span>;
</span><span>
</span><span>    </span><span style=color:#e45649;>this</span><span>.</span><span style=color:#0184bc;>setTimeout</span><span>(() </span><span style=color:#a626a4;>=> </span><span>{
</span><span>      </span><span style=color:#e45649;>this</span><span>.</span><span style=color:#0184bc;>setState</span><span>({ animate: </span><span style=color:#c18401;>true </span><span>});
</span><span>    }, </span><span style=color:#e45649;>ANIMATION_TIMEOUT</span><span>);
</span><span>  }
</span><span style=color:#a626a4;>...
</span></code></pre><iframe src="//codepen.io/stanko/embed/preview/WOERrE/?height=400&theme-id=light&default-tab=result" allowfullscreen allowtransparency frameborder=no height=400px scrolling=no>See the Pen <a href=http://codepen.io/stanko/pen/WOERrE/>Rerender React component in componentDidMount - Step 2</a> by Stanko (<a href=http://codepen.io/stanko>@stanko</a>) on <a href=http://codepen.io>CodePen</a>.</iframe><p>So this is cross browser solution, but I always cringe a little when I'm forced to use timeouts like this. And I have been talking about animation frames a lot, so why don't we try that next?<h2 id=using-requestanimationframe-instead-on-timeout>Using <code>requestAnimationFrame</code> instead on timeout<a aria-label="Anchor link for: using-requestanimationframe-instead-on-timeout" title="Anchor link for: using-requestanimationframe-instead-on-timeout" class=header-anchor href=#using-requestanimationframe-instead-on-timeout><span aria-hidden=true class=sr-only>#</span></a></h2><p>We'll just replace timeout with <code>requestAnimationFrame</code> and it should work. But not in Firefox :( to make things worse, sometimes it does, and sometimes doesn't. My guess that sometimes it gets squeezed in to the same animation frame.<h3 id=update-october-2017>Update, October 2017<a aria-label="Anchor link for: update-october-2017" title="Anchor link for: update-october-2017" class=header-anchor href=#update-october-2017><span aria-hidden=true class=sr-only>#</span></a></h3><p>Hooray! Firefox fixed this one, in newer versions it works without two nested <code>requestAnimationFrame</code>. But you might want to stick with it for some time, to make sure all of your users upgraded their browsers.<p><small>(Again just the part of the code that is changed)</small><pre class=language-tsx data-lang=tsx style=background-color:#fafafa;color:#383a42;><code class=language-tsx data-lang=tsx><span style=color:#a626a4;>...
</span><span>  </span><span style=color:#0184bc;>componentDidMount</span><span>() {
</span><span>    </span><span style=color:#a0a1a7;>// Added requestAnimationFrame
</span><span>    </span><span style=color:#0184bc;>requestAnimationFrame</span><span>(() </span><span style=color:#a626a4;>=> </span><span>{
</span><span>      </span><span style=color:#e45649;>this</span><span>.</span><span style=color:#0184bc;>setState</span><span>({ animate: </span><span style=color:#c18401;>true </span><span>});
</span><span>    });
</span><span>  }
</span><span style=color:#a626a4;>...
</span></code></pre><iframe src="//codepen.io/stanko/embed/preview/JJyEoz/?height=400&theme-id=light&default-tab=result" allowfullscreen allowtransparency frameborder=no height=400px scrolling=no>See the Pen <a href=http://codepen.io/stanko/pen/JJyEoz/>Rerender React component in componentDidMount - Step 3</a> by Stanko (<a href=http://codepen.io/stanko>@stanko</a>) on <a href=http://codepen.io>CodePen</a>.</iframe><p>So now we need to make sure our two states belong to different animation frames each.<h2 id=nested-requestanimationframe-to-the-rescue>Nested <code>requestAnimationFrame</code> to the rescue<a aria-label="Anchor link for: nested-requestanimationframe-to-the-rescue" title="Anchor link for: nested-requestanimationframe-to-the-rescue" class=header-anchor href=#nested-requestanimationframe-to-the-rescue><span aria-hidden=true class=sr-only>#</span></a></h2><p>Idea is to separate renders of two states to different animation frames. As we are not going to wrap React's <code>render</code> method into animation frame, we need to nest them instead in <code>componentDidMount</code>.<p>This way we guarantee first render won't be merged together with the second one. Problem we had in Firefox is now gone.<p>This looks hacky, but I think it is a legit solution. Instead of trying to get a <em>magic</em> value for timeout, just use native methods that browsers provide.<p><small>(Again just the part of the code that is changed)</small><pre class=language-tsx data-lang=tsx style=background-color:#fafafa;color:#383a42;><code class=language-tsx data-lang=tsx><span style=color:#a626a4;>...
</span><span>  </span><span style=color:#0184bc;>componentDidMount</span><span>() {
</span><span>    </span><span style=color:#a0a1a7;>// Added two nested requestAnimationFrames
</span><span>    </span><span style=color:#0184bc;>requestAnimationFrame</span><span>(() </span><span style=color:#a626a4;>=> </span><span>{
</span><span>      </span><span style=color:#a0a1a7;>// Firefox will sometimes merge changes that happened here
</span><span>      </span><span style=color:#0184bc;>requestAnimationFrame</span><span>(() </span><span style=color:#a626a4;>=> </span><span>{
</span><span>        </span><span style=color:#e45649;>this</span><span>.</span><span style=color:#0184bc;>setState</span><span>({ animate: </span><span style=color:#c18401;>true </span><span>});
</span><span>      });
</span><span>    });
</span><span>  }
</span><span style=color:#a626a4;>...
</span></code></pre><iframe src="//codepen.io/stanko/embed/preview/JJyEXq/?height=400&theme-id=light&default-tab=result" allowfullscreen allowtransparency frameborder=no height=400px scrolling=no>See the Pen <a href=http://codepen.io/stanko/pen/JJyEXq/>Rerender React component in componentDidMount - Step 4</a> by Stanko (<a href=http://codepen.io/stanko>@stanko</a>) on <a href=http://codepen.io>CodePen</a>.</iframe><h2 id=finally-put-it-in-a-helper>Finally, put it in a helper<a aria-label="Anchor link for: finally-put-it-in-a-helper" title="Anchor link for: finally-put-it-in-a-helper" class=header-anchor href=#finally-put-it-in-a-helper><span aria-hidden=true class=sr-only>#</span></a></h2><p>To make things a bit cleaner, I extract this to a helper function and then use whenever I need it. This can be used in our React examples but also with any other framework or vanilla JavaScript.<p>If you support browsers without <code>requestAnimationFrame</code> be sure to polyfill it. Paul Irish has a great one <a href=https://www.paulirish.com/2011/requestanimationframe-for-smart-animating/>here</a>.<pre class=language-tsx data-lang=tsx style=background-color:#fafafa;color:#383a42;><code class=language-tsx data-lang=tsx><span style=color:#a0a1a7;>// Start animation helper using nested requestAnimationFrames
</span><span style=color:#a626a4;>function </span><span style=color:#0184bc;>startAnimation</span><span>(</span><span style=color:#e45649;>callback</span><span>) {
</span><span>  </span><span style=color:#0184bc;>requestAnimationFrame</span><span>(() </span><span style=color:#a626a4;>=> </span><span>{
</span><span>    </span><span style=color:#0184bc;>requestAnimationFrame</span><span>(() </span><span style=color:#a626a4;>=> </span><span>{
</span><span>      </span><span style=color:#0184bc;>callback</span><span>();
</span><span>    });
</span><span>  });
</span><span>}
</span></code></pre><p><small>(Our <code>componentDidMount</code> code using helper)</small><pre class=language-tsx data-lang=tsx style=background-color:#fafafa;color:#383a42;><code class=language-tsx data-lang=tsx><span style=color:#a626a4;>...
</span><span>  </span><span style=color:#0184bc;>componentDidMount</span><span>() {
</span><span>    </span><span style=color:#a0a1a7;>// You'll need to import startAnimation at the top of the file
</span><span>    </span><span style=color:#0184bc;>startAnimation</span><span>(() </span><span style=color:#a626a4;>=> </span><span>{
</span><span>      </span><span style=color:#e45649;>this</span><span>.</span><span style=color:#0184bc;>setState</span><span>({ animate: </span><span style=color:#c18401;>true </span><span>});
</span><span>    });
</span><span>  }
</span><span style=color:#a626a4;>...
</span></code></pre><h2 id=at-the-end>At the end<a aria-label="Anchor link for: at-the-end" title="Anchor link for: at-the-end" class=header-anchor href=#at-the-end><span aria-hidden=true class=sr-only>#</span></a></h2><p>Hope you learned something, and I'm interested to hear if somebody is using different approach to solve this problem. Cheers!</div><div class=sharing><div class=h4>Share on:</div><div class=sharing__buttons><a class="sharing__button sharing__button--hn" href="http://news.ycombinator.com/submitlink?u=https%3A//muffinman.io/blog/react-rerender-in-component-did-mount/&t=Animate%20React%20component%20by%20calling%20%27setState%27%20in%20%27componentDidMount%27" title="Share post on Hacker News" rel=nofollow target=_blank> <svg viewbox="0 0 106 137" aria-hidden=true xmlns=http://www.w3.org/2000/svg> <path d="M44.374 82.746.433.432h20.081l25.848 52.092c.398.928.862 1.889 1.392 2.883.53.994.994 2.022 1.391 3.082.266.398.464.762.597 1.094.133.33.265.63.398.894a65.643 65.643 0 0 1 1.79 3.877c.53 1.26.993 2.42 1.39 3.48a601.604 601.604 0 0 1 3.48-7.257c1.26-2.585 2.552-5.27 3.877-8.053L86.923.432h18.69L61.273 83.74v53.087h-16.9V82.746h.001Z"/> </svg> </a><a class="sharing__button sharing__button--twitter" href="http://twitter.com/share?text=Animate%20React%20component%20by%20calling%20%27setState%27%20in%20%27componentDidMount%27&url=https%3A//muffinman.io/blog/react-rerender-in-component-did-mount/" title="Share post on Twitter" rel=nofollow target=_blank> <svg viewbox="0 0 24 24" aria-hidden=true xmlns=http://www.w3.org/2000/svg> <path d="M23.444 4.834c-.814.363-1.5.375-2.228.016.938-.562.981-.957 1.32-2.019-.878.521-1.851.9-2.886 1.104a4.545 4.545 0 0 0-7.742 4.145 12.897 12.897 0 0 1-9.366-4.748 4.525 4.525 0 0 0-.615 2.285c0 1.577.803 2.967 2.021 3.782a4.527 4.527 0 0 1-2.057-.568l-.001.057a4.547 4.547 0 0 0 3.646 4.456 4.575 4.575 0 0 1-2.053.079 4.551 4.551 0 0 0 4.245 3.155A9.138 9.138 0 0 1 1 18.459 12.865 12.865 0 0 0 7.966 20.5c8.358 0 12.928-6.924 12.928-12.929 0-.198-.003-.393-.012-.588.887-.64 1.953-1.237 2.562-2.149z"/> </svg> </a><a class="sharing__button sharing__button--reddit" href="http://www.reddit.com/submit?url=https%3A//muffinman.io/blog/react-rerender-in-component-did-mount/&title=Animate%20React%20component%20by%20calling%20%27setState%27%20in%20%27componentDidMount%27" title="Share post on reddit" rel=nofollow target=_blank> <svg viewbox="0 0 24 24" aria-hidden=true xmlns=http://www.w3.org/2000/svg> <path d="M2.204 14.049c-.06.276-.091.56-.091.847 0 3.443 4.402 6.249 9.814 6.249 5.41 0 9.812-2.804 9.812-6.249 0-.274-.029-.546-.082-.809l-.015-.032a.456.456 0 0 1-.029-.165c-.302-1.175-1.117-2.241-2.296-3.103a.422.422 0 0 1-.126-.07c-.026-.02-.045-.042-.067-.064-1.792-1.234-4.356-2.008-7.196-2.008-2.815 0-5.354.759-7.146 1.971a.397.397 0 0 1-.179.124c-1.206.862-2.042 1.937-2.354 3.123a.454.454 0 0 1-.037.171l-.008.015zm9.773 5.441c-1.794 0-3.057-.389-3.863-1.197a.45.45 0 0 1 0-.632.47.47 0 0 1 .635 0c.63.629 1.685.943 3.228.943 1.542 0 2.591-.3 3.219-.929a.463.463 0 0 1 .629 0 .482.482 0 0 1 0 .645c-.809.808-2.065 1.198-3.862 1.198l.014-.028zm-3.606-7.573c-.914 0-1.677.765-1.677 1.677 0 .91.763 1.65 1.677 1.65s1.651-.74 1.651-1.65c0-.912-.739-1.677-1.651-1.677zm7.233 0c-.914 0-1.678.765-1.678 1.677 0 .91.764 1.65 1.678 1.65s1.651-.74 1.651-1.65c0-.912-.739-1.677-1.651-1.677zm4.548-1.595c1.037.833 1.8 1.821 2.189 2.904a1.818 1.818 0 0 0-2.189-2.902v-.002zM2.711 9.963a1.82 1.82 0 0 0-1.173 3.207c.401-1.079 1.172-2.053 2.213-2.876a1.82 1.82 0 0 0-1.039-.329v-.002zm9.217 12.079c-5.906 0-10.709-3.205-10.709-7.142 0-.275.023-.544.068-.809A2.723 2.723 0 0 1 0 11.777a2.725 2.725 0 0 1 2.725-2.713 2.7 2.7 0 0 1 1.797.682c1.856-1.191 4.357-1.941 7.112-1.992l1.812-5.524.404.095s.016 0 .016.002l4.223.993a2.237 2.237 0 0 1 4.296.874c0 1.232-1.003 2.234-2.231 2.234s-2.23-1.004-2.23-2.23l-3.851-.912-1.467 4.477c2.65.105 5.047.854 6.844 2.021a2.663 2.663 0 0 1 1.833-.719 2.716 2.716 0 0 1 2.718 2.711c0 .987-.54 1.886-1.378 2.365.029.255.059.494.059.749-.015 3.938-4.806 7.143-10.72 7.143l-.034.009zm8.179-19.187a1.339 1.339 0 1 0 0 2.678c.732 0 1.33-.6 1.33-1.334 0-.733-.598-1.332-1.347-1.332l.017-.012z"/> </svg> </a></div></div></div><div class=post__bottom><div class=container><div class=related-posts><h2 class="h3 related-posts__title">Related Posts</h2><a class=related-posts__post href=https://muffinman.io/blog/react-simple-video-buffering-loader/> <div class=related-posts__post-title>Simple video buffering loader in React<svg viewbox="0 0 30 20" aria-hidden=true class=post-arrow xmlns=http://www.w3.org/2000/svg> <path d="M 0 10 30 10 20 0 30 10 20 20"/> </svg></div> <div class=related-posts__date>16. October 2020</div> </a><a class=related-posts__post href=https://muffinman.io/blog/react-router-v4-redirect-decorator/> <div class=related-posts__post-title>React Router v4 redirect decorator<svg viewbox="0 0 30 20" aria-hidden=true class=post-arrow xmlns=http://www.w3.org/2000/svg> <path d="M 0 10 30 10 20 0 30 10 20 20"/> </svg></div> <div class=related-posts__date>29. January 2018</div> </a><a class=related-posts__post href=https://muffinman.io/blog/react-ratio-component/> <div class=related-posts__post-title>React ratio<svg viewbox="0 0 30 20" aria-hidden=true class=post-arrow xmlns=http://www.w3.org/2000/svg> <path d="M 0 10 30 10 20 0 30 10 20 20"/> </svg></div> <div class=related-posts__date>23. January 2018</div> </a></div><div class=comments><h2 class="h3 comments__title" id=comments>Comments (8)</h2><div><div class=comment id=comment-3ff34970-91bb-11e7-acc3-59682e045002><div class=comment__top><img src="https://www.gravatar.com/avatar/9a4d8d0343e315a4d8a87fe23bce227d?d=mm&r=g" class=comment__avatar><div class=comment__right><div class="comment__name h5">Ariel</div><div class=comment__date>04. Sep 2017, 21:51</div></div></div><div class=comment__message><p>This tutorial is amazing. You are amazing.<p>I regularly read tutorials that leave <em>way</em> too much out or simply don't explain how they got to their solution.<p>This is spot on.<p>Love it! Please keep doing your thing!</div></div><div class=comment id=comment-4e6310e0-9200-11e7-83e6-5f4ca8e9a40d><div class=comment__top><div class="comment__avatar comment__avatar--mm"><svg viewbox="0 0 40 20" aria-hidden=true class=logo xmlns=http://www.w3.org/2000/svg> <lineargradient id=logo-gradient> <stop offset=0% stop-color=var(--gradient-color-1) /> <stop offset=70% stop-color=var(--gradient-color-2) /> </lineargradient> <path d="M19.79.5h-2.603c-2.56 0-5.04 1.377-6.003 2.754C10.22 1.877 7.742.5 5.181.5H.5v19h4.681V5.181c1.79.083 3.855 1.35 3.855 3.993V19.5h4.296V9.174c0-2.644 2.065-3.91 3.855-3.993V19.5h5.204V5.181c1.79.083 3.855 1.35 3.855 3.993V19.5h4.296V9.174c0-2.644 2.065-3.91 3.855-3.993V19.5h4.681V.5h-4.68c-2.562 0-5.04 1.377-6.004 2.754C27.43 1.877 24.952.5 22.391.5Z" fill=url(#logo-gradient) stroke-linecap=round stroke-linejoin=round stroke-width=2px vector-effect=non-scaling-stroke /> </svg></div><div class=comment__right><div class="comment__name h5">Stanko</div><div class=comment__date>05. Sep 2017, 06:06</div></div></div><div class=comment__message><p>You are welcome :) And thank you, I'm doing my best to write about real problems I encounter.<p>Cheers!</div></div><div class=comment id=comment-c8550ae0-9794-11e7-8d7a-93ae9661f3e7><div class=comment__top><img src="https://www.gravatar.com/avatar/21d5d76d61e1a368498826336440e3b7?d=mm&r=g" class=comment__avatar><div class=comment__right><div class="comment__name h5">Batu</div><div class=comment__date>12. Sep 2017, 08:31</div></div></div><div class=comment__message><p>Thank you!</div></div><div class=comment id=comment-19ac6a00-a7ad-11e7-ba25-ff198669fadf><div class=comment__top><img src="https://www.gravatar.com/avatar/7087e6dbd9dbddfb093ad400f1c042a6?d=mm&r=g" class=comment__avatar><div class=comment__right><div class="comment__name h5">Jimmy</div><div class=comment__date>02. Oct 2017, 20:05</div></div></div><div class=comment__message><p>Not sure why – but this method didn't work for me.<p>This appears to be the pattern at the moment: https://reactjs.org/docs/animation.html</div></div><div class=comment id=comment-33f21b50-a80f-11e7-8704-5b582ac668d2><div class=comment__top><div class="comment__avatar comment__avatar--mm"><svg viewbox="0 0 40 20" aria-hidden=true class=logo xmlns=http://www.w3.org/2000/svg> <lineargradient id=logo-gradient> <stop offset=0% stop-color=var(--gradient-color-1) /> <stop offset=70% stop-color=var(--gradient-color-2) /> </lineargradient> <path d="M19.79.5h-2.603c-2.56 0-5.04 1.377-6.003 2.754C10.22 1.877 7.742.5 5.181.5H.5v19h4.681V5.181c1.79.083 3.855 1.35 3.855 3.993V19.5h4.296V9.174c0-2.644 2.065-3.91 3.855-3.993V19.5h5.204V5.181c1.79.083 3.855 1.35 3.855 3.993V19.5h4.296V9.174c0-2.644 2.065-3.91 3.855-3.993V19.5h4.681V.5h-4.68c-2.562 0-5.04 1.377-6.004 2.754C27.43 1.877 24.952.5 22.391.5Z" fill=url(#logo-gradient) stroke-linecap=round stroke-linejoin=round stroke-width=2px vector-effect=non-scaling-stroke /> </svg></div><div class=comment__right><div class="comment__name h5">Stanko</div><div class=comment__date>03. Oct 2017, 07:48</div></div></div><div class=comment__message><p>Hello Jimmy, I'm sorry to hear it didn't work for you. Method works for sure, as you can see from the examples. I used it numerous times. You can check <a href=https://muffinman.io/react-animate-height/>react-animate-height</a> which is using it as well.<p><code>ReactTransitionGroup</code> and <code>ReactCSSTransitionGroup</code> are out for a while, but they do a little bit different thing.<p>Method I described is meant for a simple two-states animations. For such things I prefer doing it on my own rather than pulling whole library. Plus it gives you more control.<p>Cheers!</div></div><div class=comment id=comment-8b8a03d0-eace-11e7-a44f-935f90061bb7><div class=comment__top><img src="https://www.gravatar.com/avatar/d3e5192b0dbdba1f1d379e69526a82bc?d=mm&r=g" class=comment__avatar><div class=comment__right><div class="comment__name h5">Benjamin</div><div class=comment__date>27. Dec 2017, 06:24</div></div></div><div class=comment__message><p>I came here because animationFrame was updating too fast, and setting timeouts made it look choppy. Your double requestAnimationFrame did the trick. Would never have thought of that.</div></div><div class=comment id=comment-be87db50-715a-11e8-9910-8fe24f4e3f6a><div class=comment__top><img src="https://www.gravatar.com/avatar/bc6dfd1a2e713cd6a93c46e485294b8a?d=mm&r=g" class=comment__avatar><div class=comment__right><div class="comment__name h5">Aswin</div><div class=comment__date>16. Jun 2018, 11:45</div></div></div><div class=comment__message><p>Hi Stanko, Nice and clear write up. I have described my problem in the below "so" post. https://stackoverflow.com/questions/50881720/making-dom-updates-in-millisecond-intervals. Is rAF the way forward for websocket data too ?</div></div><div class=comment id=comment-54db1140-d654-11e8-9cf8-c9b6ddd6c0e8><div class=comment__top><img src="https://www.gravatar.com/avatar/0cf19129461493daaf6dd7bbb8fc1943?d=mm&r=g" class=comment__avatar><div class=comment__right><div class="comment__name h5">Daniel González González</div><div class=comment__date>22. Oct 2018, 23:43</div></div></div><div class=comment__message><p>Beautiful tutorial :)! Easy to adapt to different use cases. Thanks Stanko!</div></div></div></div></div></div></section><footer class=footer><div class="container footer__content"><a class=footer__rss-link href=/atom.xml target=_blank> <svg viewbox="0 0 8 8" aria-hidden=true xmlns=http://www.w3.org/2000/svg> <g fill=currentColor transform=matrix(1.3329835,0,0,1.3333333,-0.12812669,-2.6739007)> <ellipse cx=0.88595736 cy=7.2168303 rx=0.78983712 ry=0.78859526 /> <path d="m 0.09769498,5.0054256 a 3,3 0 0 1 3.00000002,3 h 1 a 4,4 0 0 0 -4.00000002,-4 z"/> <path d="m 0.09769498,3.0054256 a 5,5 0 0 1 5.00000002,5 h 1 a 6,6 0 0 0 -6.00000002,-6 z"/> </g> </svg> RSS Feed </a><div class=footer__text><a aria-label=Home class=footer__logo-link href=/> <svg viewbox="0 0 40 20" aria-hidden=true class=logo xmlns=http://www.w3.org/2000/svg> <lineargradient id=logo-gradient> <stop offset=0% stop-color=var(--gradient-color-1) /> <stop offset=70% stop-color=var(--gradient-color-2) /> </lineargradient> <path d="M19.79.5h-2.603c-2.56 0-5.04 1.377-6.003 2.754C10.22 1.877 7.742.5 5.181.5H.5v19h4.681V5.181c1.79.083 3.855 1.35 3.855 3.993V19.5h4.296V9.174c0-2.644 2.065-3.91 3.855-3.993V19.5h5.204V5.181c1.79.083 3.855 1.35 3.855 3.993V19.5h4.296V9.174c0-2.644 2.065-3.91 3.855-3.993V19.5h4.681V.5h-4.68c-2.562 0-5.04 1.377-6.004 2.754C27.43 1.877 24.952.5 22.391.5Z" fill=url(#logo-gradient) stroke-linecap=round stroke-linejoin=round stroke-width=2px vector-effect=non-scaling-stroke /> </svg> </a><p>© 2016-2022. All rights reserved.<p>Written with ♡ by Stanko Tadić. Made in Serbia.</div><nav class="nav nav--footer"><a class=nav__item href=/>Home</a><span aria-hidden=true>/</span><a class=nav__item href=/archive/> Archive </a><span aria-hidden=true>/</span><a class="nav__item nav__item--with-icon" title="On my Instagram profile" href=https://instagram.com/muffinman_io/ rel=noopener target=_blank> Art <svg viewbox="0 0 20 20" aria-hidden=true class=nav__external-icon height=10 width=10 xmlns=http://www.w3.org/2000/svg> <g fill=none stroke=currentColor stroke-linecap=round stroke-linejoin=round stroke-width=2.5> <path d="M 0 20 20 0 M 8 0 20 0 20 12"/> </g> </svg> </a><span aria-hidden=true>/</span><a class=nav__item href=/about/> About </a><span aria-hidden=true>/</span><button class="nav__item nav__item--with-icon" data-micromodal-trigger=modal-menu>Search <svg viewbox="0 0 20 32" aria-hidden=true class=nav__search-icon height=16 width=10 xmlns=http://www.w3.org/2000/svg> <g fill=none stroke=currentColor stroke-linecap=round stroke-width=3> <circle cx=10 cy=10 r=10 /> <path d="M 10 20 L 10 32"/> </g> </svg></button></nav></div></footer></div><div aria-hidden=true class=modal id=modal-menu><div class=modal__overlay><div><div aria-hidden=true class=modal__shadow></div><div aria-labelledby=modal-menu-title aria-modal=true class=modal__container role=dialog><main class=modal__content id=modal-menu-content><h2 class=sr-only id=modal-menu-title>Menu and search</h2><div class=menu><div class=container><a aria-label=Home class=menu__logo href=/> <svg viewbox="0 0 40 20" aria-hidden=true class=logo xmlns=http://www.w3.org/2000/svg> <lineargradient id=logo-gradient> <stop offset=0% stop-color=var(--gradient-color-1) /> <stop offset=70% stop-color=var(--gradient-color-2) /> </lineargradient> <path d="M19.79.5h-2.603c-2.56 0-5.04 1.377-6.003 2.754C10.22 1.877 7.742.5 5.181.5H.5v19h4.681V5.181c1.79.083 3.855 1.35 3.855 3.993V19.5h4.296V9.174c0-2.644 2.065-3.91 3.855-3.993V19.5h5.204V5.181c1.79.083 3.855 1.35 3.855 3.993V19.5h4.296V9.174c0-2.644 2.065-3.91 3.855-3.993V19.5h4.681V.5h-4.68c-2.562 0-5.04 1.377-6.004 2.754C27.43 1.877 24.952.5 22.391.5Z" fill=url(#logo-gradient) stroke-linecap=round stroke-linejoin=round stroke-width=2px vector-effect=non-scaling-stroke /> </svg> </a><button aria-label=Close class=menu__close data-micromodal-close><span></span> <span></span></button></div></div><div class=modal__top><div class=container><label class=sr-only for=search>Search</label><input class=search__input id=search placeholder=Search></div></div><div class=modal__bottom><div class=container><div class=modal-nav><a class=h1 href=/archive/> Archive </a><a title="On my Instagram profile" class=h1 href=https://instagram.com/muffinman_io/ rel=noopener target=_blank> Art </a><a class=h1 href=/about/> About </a><a class=h1 href=/atom.xml> RSS Feed </a><a class=h1 href=https://github.com/stanko/ rel=noopener target=_blank> GitHub </a></div></div><div class=search__results></div><main><div></div><div></div><script src=/js/search-data.js></script><script src=/js/app.js></script><script>if (window.location.hostname !== 'localhost' && window.location.hostname.search('.local') > -1 && window.location.hostname !== '0.0.0.0') {
      (function() {
        window.counter = 'https://muffinman_io.goatcounter.com/count';

        var script = document.createElement('script');
        script.async = 1;
        script.src = '//gc.zgo.at/count.js';
        var ins = document.getElementsByTagName('script')[0];
        ins.parentNode.insertBefore(script, ins);
      })();
    }</script>